<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Daily Water Intake Calculator</title>
  <meta name="description" content="Calculate your personalized daily water intake goal based on age, weight, gender, activity level, and climate.">
  <style>
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; max-width:550px; margin:auto; padding:20px; text-align:center; background-color: #f7f9fc; color: #333;}
    h1 { color: #0056b3; }
    .form-section { background-color: white; border: 1px solid #e0e6ed; padding: 20px; margin-bottom: 20px; border-radius: 8px; text-align: left; }
    label { display: block; margin-bottom: 15px; font-weight: 500; }
    input[type="number"], select { width:100%; padding:12px; margin-top: 5px; font-size:1rem; border-radius:5px; border:1px solid #ccc; box-sizing: border-box; transition: border-color 0.2s, box-shadow 0.2s;}
    input:focus, select:focus { outline: none; border-color: #007bff; box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.2); }
    button { width: 100%; background-color: #007bff; color: white; padding: 15px; font-size: 1.2rem; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.2s; font-weight: bold;}
    button:hover { background-color: #0056b3; }
    #result { font-size:1.6rem; margin:25px 0; font-weight: bold; color: #0056b3; min-height: 2.2rem; transition: opacity 0.3s;}
    .checkbox-label { display: flex; align-items: center; }
    .checkbox-label input { width: auto; margin-right: 10px; }
  </style>
</head>
<body>
  <h1>Daily Water Intake Calculator</h1>

  <div class="form-section">
    <label>Your Age (years)
      <input id="age" type="number" min="1" max="120" value="30" required>
    </label>
    <label>Your Weight (lbs)
      <input id="weightLbs" type="number" min="50" max="500" value="150" required>
    </label>
    <label>Your Gender
      <select id="gender">
        <option value="male" selected>Male</option>
        <option value="female">Female</option>
      </select>
    </label>
  </div>

  <div class="form-section">
    <label>Daily Activity Level
      <select id="activityLevel">
        <option value="sedentary">Sedentary (little to no exercise)</option>
        <option value="light" selected>Light (exercise 1-3 days/week)</option>
        <option value="moderate">Moderate (exercise 3-5 days/week)</option>
        <option value="high">High (exercise 6-7 days/week)</option>
        <option value="extreme">Extreme (physical job or training twice/day)</option>
      </select>
    </label>
    <label class="checkbox-label">
      <input id="isTropical" type="checkbox"> I am in a tropical climate
    </label>
  </div>

  <button id="calc">Calculate</button>
  <div id="result"></div>

  <script>
    document.getElementById('calc').onclick = async () => {
      const resultEl = document.getElementById('result');
      resultEl.style.opacity = '0.5';
      resultEl.innerText = 'Calculating...';

      const payload = {
        age: +document.getElementById('age').value,
        weightLbs: +document.getElementById('weightLbs').value,
        gender: document.getElementById('gender').value,
        activityLevel: document.getElementById('activityLevel').value,
        isTropical: document.getElementById('isTropical').checked
      };

      try {
        // We use the original, working API endpoint
        const response = await fetch('/api/calculate', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(payload)
        });
        const data = await response.json();
        if (!response.ok) throw new Error(data.error || 'Calculation failed.');

        resultEl.innerText = `Daily Goal: ${data.displayText}`;

      } catch (error) {
        resultEl.innerText = `Error: ${error.message}`;
      } finally {
        resultEl.style.opacity = '1';
      }
    };
  </script>
</body>
</html>
